## 1. 定义和定理

?> **定义1（线性逼近）：**明文-密文对 $(P,C)$ 在输入输出掩码对$(\alpha,\beta)$下的线性组合的异或值$\alpha \cdot P\oplus \beta \cdot C$。

?> **定义2（线性相关度）：**明文-密文对 $(P,C)$ 在输入输出掩码对$(\alpha,\beta)$线性逼近的值为0的概率 $p$ ：
$$
p=Pr(\alpha \cdot P\oplus \beta \cdot C=0)
$$

?> **定义3（线性偏差）：**明文-密文的线性相关度和 $\frac{1}{2}$ 的偏差：
$$
\epsilon =p-\frac{1}{2}
$$

?> **定义4（线性相关度）：**线性逼近的值为0的概率和值为1的概率之差
$$
\begin{align*}
Cor &=Pr(\alpha \cdot P\oplus \beta \cdot C=0)-Pr(\alpha \cdot P\oplus \beta \cdot C=1) \\
&=p-(1-p) \\
&=2p-1
\end{align*}
$$

?> **定义1（堆积引理）：**假设有这样的线性路径 $\alpha_{0} \rightarrow \alpha_{1} \rightarrow \alpha_{2}\rightarrow,\cdots,\rightarrow \alpha_{n}$ 其线性概率分别为 $Pr(\alpha_{0},\alpha_{1})=\epsilon_{0}+\frac{1}{2}, Pr(\alpha_{1},\alpha_{2})=\epsilon_{1}+\frac{1}{2}, \cdots, Pr(\alpha_{n-1},\alpha_{n})=\epsilon_{n-1}+\frac{1}{2}$，则线性概率 $Pr(\alpha_{0},\alpha_{n})=\frac{1}{2}+2^{n-1} \prod_{i=1}^{n-1} \epsilon_{i} $。

`证明`：有这样一组概率:
$$Pr(x_{0}=0)=p_{0},~Pr(x_{1}=0)=p_{1},~\cdots~,Pr(x_{n-1}=0)=p_{n-1}$$
假设这些变量之间相互独立，则有：
$$Pr(x_{0}=i,x_{1}=j)=
\begin{cases}
p_{0}\cdot p_{1} & i=0,j=0 \\
p_{0}\cdot (1-p_{1}) & i=0,j=1 \\
p_{1}\cdot (1-p_{0}) & i=1,j=0 \\
(1-p_{0})\cdot (1-p_{1}) & i=1,j=1 
\end{cases}
$$
所以有：
$$
\begin{align*}
    Pr(x_{0}=x_{1})&=p_{0}\cdot p_{1}+(1-p_{0})\cdot (1-p_{1}) \\
    &=(\frac{1}{2}+\epsilon_{0})(\frac{1}{2}+\epsilon_{1})+(\frac{1}{2}-\epsilon_{0})(\frac{1}{2}-\epsilon_{1}) \\
    &=\frac{1}{2}+2\epsilon_{0}\epsilon_{1}
\end{align*}
$$
推广到多个，则有：
$$
Pr(x_{0}=x_{1}=x_{2}=\cdots =x_{n-1})=\frac{1}{2}+2^{n-1}\times \prod_{i=0}^{n}\epsilon _{i} 
$$
令$Pr(x_{0}\oplus x_{1}=0)=\frac{1}{2}+\epsilon_{0},Pr(x_{1} \oplus x_{2}=0)=\frac{1}{2}+\epsilon_{1}$，则 $x_{0}\oplus x_{2}=0 \Leftrightarrow x_{0}\oplus x_{1}=x_{1}\oplus x_{2}$。  
所以有：
$$Pr(x_{0}\oplus x_{2}=0)=\frac{1}{2}+2\epsilon_{0}\epsilon_{1}$$
由以上和结果和堆积引理可得：
$Pr(x_{0}\oplus x_{1})=\frac{1}{2}+\epsilon_{0},~Pr(x_{1}\oplus x_{2})=\frac{1}{2}+\epsilon_{1},\cdots,Pr(x_{n-2}\oplus x_{n-1})=\frac{1}{2}+\epsilon_{n-1}\Rightarrow Pr(x_{0}\oplus x_{n-1})=\frac{1}{2}+2^{n-1}\prod_{i=0}^{i=n-1}\epsilon_{i}$

## 2. 攻击模型